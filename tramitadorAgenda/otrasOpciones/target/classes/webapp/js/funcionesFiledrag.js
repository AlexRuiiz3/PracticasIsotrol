var ar=[];$("#messages").hide();function adjuntarDoc(){if(ar.length==0){window.alert("Debe adjuntar al menos un documento.")}else{window.capaEspera=cargarCapaEspera();var f=ar;var d=$("#refDoc").val();var e=new FormData();var a=$("#onlyPDF").val();var c=$("#onlyXML").val();var b=false;$.each(f,function(h,g){var l=g.name.split(".");if(l.length>=2){var k="";var j=g.name.split(".");for(h=0;h<j.length-1;h++){k+=j[h]+="_"}k=k.substring(0,k.length-1);k+=".";k+=j[j.length-1];if(a=="true"){var m=k.split(".");if(m[1]=="pdf"||m[1]=="PDF"){e.append("file",g,k)}else{window.alert("Los documentos adjuntos en esta fase deben estar en formato PDF");b=true;return false}}else{if(c=="true"){var m=k.split(".");if(m[1]=="xml"){e.append("file",g,k)}else{window.alert("Los documentos adjuntos en esta fase deben estar en formato XML");b=true;return false}}else{e.append("file",g,k)}}}else{if(a=="true"){var m=g.name.split(".");if(m[1]=="pdf"){e.append("file",g)}else{window.alert("Los documentos adjuntos en esta fase deben estar en formato PDF");b=true;return false}}else{if(c=="true"){var m=g.name.split(".");if(m[1]=="xml"){e.append("file",g)}else{window.alert("Los documentos adjuntos en esta fase deben estar en formato XML");b=true;return false}}else{e.append("file",g)}}}});if(!b){e.append("refDoc",d);$.apply($.ajax({type:"POST",url:"../otrasOpciones/subirDocumento.action",processData:false,contentType:false,data:e,success:function(g){overlayExito(window.capaEspera);opener.recargaPadre([["capa_doc_asoc","../modulos/docsAsociadosExpediente/listarDocumentos.action",""],["capa_tramita","../modulos/tramitacion/listarTransicionesExpediente.action",""],["ayudaTramitacion","../modulos/ayudaTramitacion/listarTransicionesExpediente.action",""],["capa_doc_perm","../modulos/bloquesPermitidos/listarBloquesPermitidos.action",""],["jerarquizacionDocumentos","../modulos/jerarquizacionDocumentos/inicioJerarquizacionDocumentos.action",""]]);opener.recargaPadreModulosObservados("capa_doc_asoc");opener.recargaPadreModulosObservados("jerarquizacionDocumentos");window.close()},error:function(g){alert("ERROR: No se han podido adjuntar los archivos seleccionados.");overlayError(window.capaEspera)}}))}else{overlayError(window.capaEspera)}}}function eliminaDoc(a){var e=[];for(var b=0,d;d=ar[b];b++){var c=d.name;c=c.split(".").join("");c=c.split(" ").join("");if(c!=a){e.push(ar[b])}}ar=e;a=a.replace(".","");a=a.replace(" ","");a=a.replace("(","");a=a.replace(")","");fileid="#file"+a;filexid="#filex"+a;$(fileid).remove();if(ar.length==0){$("#messages").hide()}$("#fileselect").files=ar}function compruebaDocumentosAdjuntos(){if(ar.length==0){window.alert("Debe adjuntar al menos un documento.");return false}else{return true}};